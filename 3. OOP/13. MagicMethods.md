# Магические методы
В ООП PHP магические методы — это специальные методы, имена которых начинаются с двойного подчеркивания __, и которые автоматически вызываются в определённых ситуациях.

Они позволяют переопределить стандартное поведение объектов, например при доступе к несуществующим свойствам, вызове метода, сериализации и т.д.


## Основные магические методы PHP
| Метод            | Когда вызывается                                                |
| ---------------- | --------------------------------------------------------------- |
| `__construct()`  | При создании объекта                                            |
| `__destruct()`   | При уничтожении объекта (в конце скрипта)                       |
| `__call()`       | При вызове **несуществующего метода** объекта                   |
| `__callStatic()` | При вызове **несуществующего статического метода**              |
| `__get()`        | При обращении к **несуществующему свойству**                    |
| `__set()`        | При попытке **записать в несуществующее свойство**              |
| `__isset()`      | При проверке `isset()` или `empty()` на несуществующее свойство |
| `__unset()`      | При использовании `unset()` на несуществующее свойство          |
| `__toString()`   | Когда объект приводится к строке                                |
| `__invoke()`     | Когда объект вызывается как функция                             |
| `__clone()`      | При клонировании объекта (`clone`)                              |
| `__sleep()`      | При сериализации (`serialize()`)                                |
| `__wakeup()`     | При десериализации (`unserialize()`)                            |
| `__debugInfo()`  | При использовании `var_dump()`                                  |


## Примеры
✅ __get() и __set()
```php
class User {
    private $data = [];

    public function __get($name) {
        return $this->data[$name] ?? null;
    }

    public function __set($name, $value) {
        $this->data[$name] = $value;
    }
}

$user = new User();
$user->name = "Alice";
echo $user->name; // Alice
```

✅ __call() и __callStatic()
```php
class Magic {
    public function __call($name, $arguments) {
        echo "Метод $name не существует. Аргументы: " . implode(', ', $arguments);
    }

    public static function __callStatic($name, $arguments) {
        echo "Статический метод $name не существует.";
    }
}

$m = new Magic();
$m->doSomething("arg1", "arg2"); // Метод doSomething не существует...
Magic::staticMethod();           // Статический метод staticMethod не существует.
```

✅ __toString()
```php
class Book {
    public function __toString() {
        return "Это книга.";
    }
}

$b = new Book();
echo $b; // Это книга.
```

✅ __invoke()
```php
class Greeter {
    public function __invoke($name) {
        return "Привет, $name!";
    }
}

$greet = new Greeter();
echo $greet("Иван"); // Привет, Иван!
```

## Важно
- Магические методы не заменяют обычные методы — они дополняют поведение класса
- Не стоит злоупотреблять ими: много магии = плохая читаемость
- В PHP не существует `__del__` как в Python, но есть __destruct()
